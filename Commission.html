<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemstone Price Calculator - Commission</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex flex-col min-h-screen">
    <nav class="bg-blue-500 text-white p-4">
        <div class="container mx-auto flex justify-center space-x-4">
            <a href="Selling and Cost.html" class="hover:underline">Selling Price, Astrologer Price and Commission</a>
            <a href="Cost Finder.html" class="hover:underline">Cost Price and Commission for Astrologer</a>
            <a href="Commission.html" class="font-bold hover:underline">Commission from Selling Price and Cost Price</a>
        </div>
    </nav>
    <div class="flex items-center justify-center flex-grow">
        <div class="bg-white p-8 rounded-lg shadow-lg w-full max-w-md">
            <h1 class="text-2xl font-bold text-center mb-6">Commission Calculator</h1>
            <div class="space-y-4">
                <div>
                    <label for="sp" class="block text-sm font-medium text-gray-700">Selling Price</label>
                    <input type="number" id="sp" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" placeholder="Enter selling price" required>
                </div>
                <div>
                    <label for="p_told" class="block text-sm font-medium text-gray-700">Price Told to Astrologer</label>
                    <input type="number" id="p_told" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" placeholder="Enter price told to astrologer" required>
                </div>
                <div>
                    <label for="ratti" class="block text-sm font-medium text-gray-700">Ratti</label>
                    <input type="number" id="ratti" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" placeholder="Enter ratti" required>
                </div>
                <div>
                    <label for="add_on" class="block text-sm font-medium text-gray-700">Add-on Type</label>
                    <select id="add_on" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" onchange="toggleMaterialDropdown()">
                        <option value="loose">Loose</option>
                        <!-- <option value="pendant">Pendant</option>
                        <option value="ring">Ring</option> -->
                    </select>
                </div>
                <div id="material_container" class="hidden">
                    <label for="material" class="block text-sm font-medium text-gray-700">Material</label>
                    <select id="material" class="mt-1 block w-full p-2 border border-gray-300 rounded-md">
                        <option value="silver">Silver</option>
                        <option value="other">Other Material</option>
                    </select>
                </div>
                <div>
                    <label for="gemstone" class="block text-sm font-medium text-gray-700">Gemstone Type</label>
                    <select id="gemstone" class="mt-1 block w-full p-2 border border-gray-300 rounded-md">
                        <option value="premium">Premium</option>
                        <option value="exclusive">Exclusive</option>
                    </select>
                </div>
                <button onclick="calculatePrice()" class="w-full bg-blue-500 text-white p-2 rounded-md hover:bg-blue-600">Calculate</button>
                <div id="result" class="mt-4 text-center text-lg font-semibold space-y-2"></div>
            </div>
        </div>
    </div>
    <script>
        function toggleMaterialDropdown() {
            const addOn = document.getElementById('add_on').value;
            const materialContainer = document.getElementById('material_container');
            if (addOn === 'loose') {
                materialContainer.classList.add('hidden');
            } else {
                materialContainer.classList.remove('hidden');
            }
        }

        function calculatePrice() {
            const sp = parseFloat(document.getElementById('sp').value);
            const p_told = parseFloat(document.getElementById('p_told').value);
            const ratti = parseFloat(document.getElementById('ratti').value);
            const add_on = document.getElementById('add_on').value;
            const material = document.getElementById('material').value;
            const gemstoneType = document.getElementById('gemstone').value;

            if (isNaN(sp) || isNaN(p_told) || isNaN(ratti)) {
                document.getElementById('result').innerText = 'Please enter valid numbers for Selling Price, Price to be Told, and Ratti';
                return;
            }

            if (ratti === 0) {
                document.getElementById('result').innerText = 'Ratti cannot be zero';
                return;
            }

            let box_cost = 0;
            let shipping_cost = 0;
            let material_cost = 0;

            if (gemstoneType === 'premium') {
                box_cost = 20;
                shipping_cost = 66;
            } else if (gemstoneType === 'exclusive') {
                box_cost = 250;
                shipping_cost = 1000;
            }

            if (add_on !== 'loose') {
                material_cost = material === 'silver' ? 750 : 500;
            } else {
                material_cost = 0;
            }

            const tech_fee = 0.02 * sp;
            const inner_sum = p_told / 1.3;
            const base = (inner_sum - (1.012 * material_cost) - (1.02 * box_cost) - shipping_cost - tech_fee) / 1.012;
            
            if (base < 0) {
                document.getElementById('result').innerText = 'Calculated cost price is negative. Please check inputs.';
                return;
            }

            const cpr = base / ratti;
            const commission = 0.5 * (sp / 1.03 - p_told);

            document.getElementById('result').innerHTML = `
                Maximum Cost Price of Gemstone: ${base.toFixed(2)}<br>
                Cost per Ratti should be less than ${cpr.toFixed(2)}<br>
                Commission: ${commission.toFixed(2)}
            `;
        }

        // Initialize material dropdown visibility on page load
        toggleMaterialDropdown();
    </script>
</body>
</html>
